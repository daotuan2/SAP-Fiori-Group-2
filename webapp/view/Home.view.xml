<mvc:View controllerName="freestyleui5fiori.freestyleui5fiori.controller.Home"
    xmlns:mvc="sap.ui.core.mvc" displayBlock="true"
    xmlns="sap.m" xmlns:table="sap.ui.table"
    xmlns:core="sap.ui.core">
    <Page id="page" title="{i18n>title}">
        <content>
            <!-- Bộ lọc tìm kiếm -->
            <VBox id="idVbox3" class="sapUiSmallMargin">
                <!-- Bộ lọc chức danh -->
                <HBox id="idVbox4" alignItems="Center" class="sapUiSmallMarginBottom">
                    <Label id="idLable6" text="Mã chức danh:" />
                    <Input id="searchCode" width="250px" showValueHelp="true" valueHelpRequest="onValueHelpCode" class="sapUiSmallMarginBegin"/>

                    <Label id="idLable7" text="Tên chức danh:" class="sapUiSmallMarginBegin"/>
                    <Input id="searchName" width="250px" showValueHelp="true" valueHelpRequest="onValueHelpName" class="sapUiSmallMarginBegin"/>

                    <Button id="idbutton6" text="Go" type="Emphasized" press="onSearch" class="sapUiSmallMarginBegin"/>
                </HBox>
            </VBox>

            <!-- Toolbar chức năng -->
            <Toolbar id="actionToolbar" class="sapUiSmallMarginTop">
                <Button id="createButton" text="Tạo" icon="sap-icon://add" press="onOpenCreateDialog"/>
                <Button id="deleteButton" text="Xóa" icon="sap-icon://delete" press="onDeleteSelected"/>
                <Button id="updateButton" text="Cập nhật" icon="sap-icon://edit" press="onOpenUpdateDialog"/>
                <Button id="idbutton5" text="Gửi Email" icon="sap-icon://email" press="onSendEmail"/>
                <Button id="idbutton9" text="Tempale Email" icon="sap-icon://form" press="onDisplayTemplateEmail"/>
            </Toolbar>

            <!-- Tab danh sách -->
            <!-- UI5 tự động gọi OData service và binding dữ liệu vào bảng -->
            <IconTabBar id="mainTabBar" class="sapUiSmallMarginTop"  select="onTabSelect" applyContentPadding="true">
                <items>
                    <IconTabFilter id="idicontabfilter" text="Danh sách chức danh" key="titles" icon="sap-icon://employee" >
                        <!-- <Table id="jobTable" items="{ProductsModel>/Job_Title_EntitySet}" mode="SingleSelectMaster" selectionChange="onRowPress"> -->
                        <Table id="jobTable"
                                busy="{ProductsModel>/isProductsDataLoading}"
                                items="{ path: 'ProductsModel>/tableData'}"
                                mode="SingleSelectMaster"
                                selectionChange="onRowSelect"
                                inset="false"
                                showSeparators="All"
                                alternateRowColors="true"
                                class="sapUiResponsiveMargin">
                            <columns>
                                <Column id="idcolumn1"><Text id="idtext1" text="Mã chức danh"/></Column>
                                <Column id="idcolumn2"><Text id="idtext2" text="Tên chức danh"/></Column>
                                <!-- <Column id="idcolumn4"><Text id="idtext5" text="Trạng thái"/></Column> -->
                                <Column id="idcolumn9"><Text id="idtext6" text="Người tạo"/></Column>
                                <Column id="idcolumn10"><Text id="idtext7" text="Ngày tạo"/></Column>
                                <!-- Cột mới cho nút detail --> 
                                <Column id="idcolumn11" hAlign="Center" width="3rem"> <Text id="idtext13" text=""/> </Column>
                            </columns>
                            <items>
                                <ColumnListItem id="idcolumnlistitem1"
                                                type="Inactive"
                                                highlight="None"
                                                vAlign="Middle">
                                    <cells>
                                        <Text id="idtext3" text="{ProductsModel>JT_CODE}"/>
                                        <Text id="idtext4" text="{ProductsModel>JT_NAME}"/>
                                        <!-- <ObjectStatus id='objectstatus1' 
                                        text="{path: 'ProductsModel>STATUS', formatter: '.formatter.statusText'}" 
                                        state="{path: 'ProductsModel>STATUS', formatter: '.formatter.statusState'}"/> -->
                                        <Text id="idtext15" text="{ProductsModel>CREATED_BY}"/>
                                        <Text id="idtext17" text="{path: 'ProductsModel>CREATED_DATE', formatter: '.formatter.formatDateTime'}"/>
                                        <!-- Nút mũi tên --> 
                                        <Button id='button1' icon="sap-icon://navigation-right-arrow" type="Transparent" press="onRowButton"/>
                                    </cells>
                                </ColumnListItem>
                            </items>
                        </Table>
                        <OverflowToolbar id='overflow1'>
                        <ToolbarSpacer id='toolbar1'/>
                        <Button id="BtnFirstPressId" icon="sap-icon://close-command-field" press="onFirstPress" tooltip="First" enabled="{NavModel>/firstPageBtnEnable}" />
                        <Button id="BtnPreviousPressId" icon="sap-icon://navigation-left-arrow" press="onPreviousPress" tooltip="Previous" enabled="{NavModel>/firstPageBtnEnable}" />
                        <Text id="PageTextId" text="{i18n>page} {ProductsModel>/page} {i18n>of} {ProductsModel>/totalPages}" />
                        <Button id="BtnNextPressId" icon="sap-icon://navigation-right-arrow" press="onNextPress" tooltip="Next" enabled="{NavModel>/nextPageBtnEnable}" />
                        <Button id="BtnLastPressId" icon="sap-icon://open-command-field" press="onLastPress" tooltip="Last" enabled="{NavModel>/nextPageBtnEnable}" />
                        </OverflowToolbar>
                    </IconTabFilter>

                    <!-- Tab danh sách email -->
                    <!-- binding vào model "tree" và hiện thị từ model đó-->
                    <IconTabFilter id="idicontabfilter1" text="Danh sách email người dùng" key="emails" icon="sap-icon://email">
                        <table:TreeTable id="emailTreeTable" rows="{tree>/nodes}" selectionMode="Single" visibleRowCount="15">
                            <table:columns>
                                <table:Column id="idcol1" width="8rem">
                                    <Label id="idla1" text="Công Ty"/>
                                    <table:template>
                                        <Text id="idte1" text="{tree>COMPANY_CODE}"/>
                                    </table:template>
                                </table:Column>

                                <table:Column id="idcol2" width="12rem">
                                    <Label id="idla2" text="Nhóm Chức Danh"/>
                                    <table:template>
                                        <Text id="idte2" text="{tree>JT_NAME}"/>
                                    </table:template>
                                </table:Column>

                                <table:Column id="idcol5">
                                    <Label id="idla5" text="Mã Cán Bộ"/>
                                    <table:template>
                                        <Text id="idte5" text="{tree>USERNAME_CODE}"/>
                                    </table:template>
                                </table:Column>

                                <table:Column id="idcol4">
                                    <Label id="idla4" text="Tên Cán Bộ"/>
                                    <table:template>
                                        <Text id="idte4" text="{tree>USERNAME}"/>
                                    </table:template>
                                </table:Column>

                                <table:Column id="idcol3">
                                    <Label id="idla3" text="Email"/>
                                    <table:template>
                                        <Text id="idte3" text="{tree>EMAIL}"/>
                                    </table:template>
                                </table:Column>
                            </table:columns>
                        </table:TreeTable>
                    </IconTabFilter>
                </items>
            </IconTabBar>
        </content>
    </Page>
</mvc:View>
